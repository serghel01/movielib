<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MovieLib - Demo</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    :root{--accent:#e50914}
    body{background:#0f0f0f;color:#eee;font-family:Inter,Arial,Helvetica,sans-serif}
    .navbar{background:#000}
    .brand{color:var(--accent);font-weight:700}
    .movie-card{background:#151515;border-radius:8px;overflow:hidden;transition:transform .18s}
    .movie-card:hover{transform:scale(1.03)}
    .sidebar{width:240px;background:#0b0b0b;position:fixed;top:0;left:0;height:100vh;padding-top:64px;display:none}
    .sidebar a{color:#cfcfcf;padding:12px 18px;display:block;text-decoration:none}
    .sidebar a:hover{background:var(--accent);color:#fff}
    #adminContent{margin-left:0;transition:margin-left .2s;padding:18px}
    #adminContent.open{margin-left:240px}
    .carousel-item img{height:420px;object-fit:cover}
    .card img{object-fit:cover}
    footer{opacity:.7;padding:24px 0}
    .small-muted{color:#bdbdbd}
    .centered {min-height: 60vh; display:flex; align-items:center; justify-content:center}
  </style>
</head>
<body>
  <!-- NAVBAR -->
  <nav class="navbar navbar-dark fixed-top">
    <div class="container-fluid">
      <a class="navbar-brand brand" href="#">üé¨ MovieLib</a>
      <div class="d-flex gap-2 align-items-center">
        <button class="btn btn-outline-light" data-bs-toggle="modal" data-bs-target="#loginModal" id="openLoginBtn">Login</button>
        <button class="btn btn-danger d-none" id="logoutBtn">Logout</button>
        <button class="btn btn-dark border border-2 text-light d-none" id="openDashboardBtn">Dashboard</button>
      </div>
    </div>
  </nav>

  <!-- SIDEBAR (admin) -->
  <div class="sidebar" id="sidebar">
    <a href="#" onclick="showAdminSection('admin_add')">üì• Agregar pel√≠cula</a>
    <a href="#" onclick="showAdminSection('admin_list')">üìã Listado</a>
    <a href="#" onclick="showAdminSection('admin_player')">‚ñ∂Ô∏è Reproductor</a>
  </div>

  <!-- HERO CARRUSEL -->
  <div class="container mt-5 pt-4">
    <div id="heroCarousel" class="carousel slide mb-4">
      <div class="carousel-inner" id="carouselInner"></div>
      <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon"></span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon"></span>
      </button>
    </div>

    <!-- GRID PEL√çCULAS -->
    <div id="publicGridContainer">
      <div class="row" id="publicGrid"></div>
    </div>

    <div id="emptyNotice" class="centered d-none">
      <div class="text-center">
        <h3>No hay pel√≠culas a√∫n</h3>
        <p class="small-muted">Inicia sesi√≥n como admin y sube la primera pel√≠cula.</p>
      </div>
    </div>
  </div>

  <!-- ADMIN CONTENT -->
  <div id="adminContent" class="container-fluid">
    <div id="admin_add" class="admin-section d-none">
      <h3 class="mb-3">Agregar pel√≠cula</h3>
      <form id="formAdd">
        <div class="mb-2"><input id="fldTitle" class="form-control" placeholder="T√≠tulo" required></div>
        <div class="mb-2"><textarea id="fldDesc" class="form-control" placeholder="Descripci√≥n"></textarea></div>
        <div class="mb-2"><label class="form-label small-muted">Poster (imagen)</label><input id="fldPoster" type="file" accept="image/*" class="form-control" required></div>
        <div class="mb-2"><label class="form-label small-muted">Video (mp4 recomendado)</label><input id="fldVideo" type="file" accept="video/*" class="form-control" required></div>
        <div class="mb-2"><div class="progress"><div id="uploadProgress" class="progress-bar bg-danger" role="progressbar" style="width:0%">0%</div></div></div>
        <div class="mb-2"><button id="btnUpload" class="btn btn-danger">Subir pel√≠cula</button></div>
      </form>
    </div>

    <div id="admin_list" class="admin-section d-none">
      <h3 class="mb-3">Listado de pel√≠culas</h3>
      <div id="adminList"></div>
    </div>

    <div id="admin_player" class="admin-section d-none">
      <h3 class="mb-3">Reproductor admin (preview)</h3>
      <video id="adminPreview" controls class="w-100" style="background:#000"></video>
    </div>
  </div>

  <!-- MODAL Reproductor p√∫blico -->
  <div class="modal fade" id="modalPlayer" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content bg-dark">
        <div class="modal-header border-0">
          <h5 id="modalTitle" class="modal-title"></h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <video id="publicPlayer" class="w-100" controls style="background:#000"></video>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL LOGIN -->
  <div class="modal fade" id="loginModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content bg-dark text-light">
        <div class="modal-header border-0"><h5 class="modal-title">Iniciar sesi√≥n</h5><button class="btn-close btn-close-white" data-bs-dismiss="modal"></button></div>
        <div class="modal-body">
          <input id="loginEmail" type="email" class="form-control mb-2" placeholder="Correo">
          <input id="loginPass" type="password" class="form-control mb-2" placeholder="Contrase√±a">
        </div>
        <div class="modal-footer"><button id="btnLogin" class="btn btn-danger w-100">Ingresar</button></div>
      </div>
    </div>
  </div>

  <footer class="text-center text-muted mt-4">MovieLib ‚Äî demo</footer>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
  import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";
  import { getFirestore, collection, addDoc, serverTimestamp, doc, deleteDoc, updateDoc, onSnapshot, query, orderBy } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";
  import { getStorage, ref, uploadBytesResumable, getDownloadURL } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-storage.js";

  // ‚úÖ Configuraci√≥n corregida
  const firebaseConfig = {
    apiKey: "AIzaSyAximGEWo7btApeke9jSLFJ5mxljKCkvRk",
    authDomain: "movielib-7ccdc.firebaseapp.com",
    projectId: "movielib-7ccdc",
    storageBucket: "movielib-7ccdc.appspot.com",
    messagingSenderId: "177203821691",
    appId: "1:177203821691:web:e9b699f7b11e1ffe6876de",
    measurementId: "G-YZCMVNW6S4"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);
  const storage = getStorage(app);

  // UID admin
  const adminUID = "zmfr5MKrcPWacHaEB7p3obJ7Dcm2";

  // --- el resto del c√≥digo sigue igual ---
  // (todo el manejo de auth, subida de archivos, listado, carrusel, etc.)
  </script>
</body>
</html>
